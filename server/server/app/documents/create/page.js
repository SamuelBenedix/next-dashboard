(()=>{var e={};e.id=248,e.ids=[248],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},15092:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/documents/create/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/documents/create/page.tsx","default")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},23258:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>l});var s=r(65239),a=r(48088),n=r(88170),i=r.n(n),o=r(30893),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(t,d);let l={children:["",{children:["documents",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,15092)),"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/documents/create/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/documents/create/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/documents/create/page",pathname:"/documents/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32367:(e,t,r)=>{Promise.resolve().then(r.bind(r,15092))},33873:e=>{"use strict";e.exports=require("path")},34053:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(60687),a=r(43210),n=r(30036),i=r(89667),o=r(903),d=r(56896),l=r(80013),c=r(70146),u=r(39941),p=r(77567),m=r(29523),h=r(16189),x=r(41862);r(45837),r(44719);var f=r(15079);function g({data:e,labelKey:t,valueKey:r,placeholder:a="Pilih opsi",onChange:n,filterKey:i,filterExclude:o}){let d=i&&o?e.filter(e=>e[i]!==o):e;return(0,s.jsxs)(f.l6,{onValueChange:n,children:[(0,s.jsx)(f.bq,{className:"w-full",children:(0,s.jsx)(f.yv,{placeholder:a})}),(0,s.jsx)(f.gC,{children:d.map(e=>(0,s.jsx)(f.eb,{value:String(e[r]),children:String(e[t])},String(e[r])))})]})}let v=(0,n.default)(async()=>{},{loadableGenerated:{modules:["app/documents/create/page.tsx -> @/components/ui/PdfRenderer"]},ssr:!1});function b(){let e=(0,h.useRouter)(),t=new u.x,[r,n]=(0,a.useState)(null),[f,b]=(0,a.useState)(null),[j,y]=(0,a.useState)([]),[S,w]=(0,a.useState)(!1),[P,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(0),[q,D]=(0,a.useState)(0),[A,_]=(0,a.useState)({width:0,height:0}),[E,G]=(0,a.useState)(!1),[T,R]=(0,a.useState)(0),[F,z]=(0,a.useState)(0),[M,H]=(0,a.useState)(200),[U,K]=(0,a.useState)(100),[B,I]=(0,a.useState)(""),[Y,J]=(0,a.useState)(""),$=async e=>{let t=e.target.files?.[0];if(!t||"application/pdf"!==t.type)return void alert("Mohon unggah file PDF!");try{N(!0);let e=await t.arrayBuffer();console.log("buffer",e),n(e),b(t),w(!0)}catch(e){console.error("Error uploading file:",e)}finally{N(!1)}};async function O(r){if(!f&&"send"!==r)return void p.A.fire("Error","Please upload a PDF document","error");try{if(!(await p.A.fire({title:"Are you sure?",text:"draft"===r?"You are about to save this document as a draft.":"sign"===r?"You are about to sign this document.":"You are about to send this document.",icon:"warning",showCancelButton:!0,confirmButtonText:`Yes, ${r}!`})).isConfirmed)return;if(N(!0),"sign"===r&&!B)return void p.A.fire("Validation Error","Please fill in the reason field.","error");if("send"===r&&!Y)return void p.A.fire("Validation Error","Please provide recipient and description.","error");try{let s=new FormData;f&&s.append("Document",f),B&&s.append("Reason",B),Y&&s.append("SendToNpp",Y),"sign"===r?(s.append("Xloc",Math.round(T).toString()),s.append("Yloc",Math.round(F).toString()),s.append("Size",M.toString()),s.append("PageNumber",k.toString()),s.append("IsDraft","false")):s.append("IsDraft","draft"===r?"true":"false");let a=await t.signCertified(s);p.A.fire("Success",a.data.data.message||"Operation completed","success").then(()=>{e.push("/documents")})}catch(e){console.error(e),p.A.fire("Error","Something went wrong. Please try again.","error")}}catch(e){console.error("Error during submission:",e)}finally{N(!1)}}return(0,s.jsxs)(c.e7,{breadcrumb:{parent:{name:"Dashboard"},current:"Dokumen"},createButtonText:"Create Document",isCreate:!0,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[(0,s.jsx)("div",{className:"md:col-span-7 col-span-12 relative p-4 min-h-[calc(100vh-100px)] bg-gray-200",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex items-center mb-2",children:(0,s.jsx)("select",{className:"p-2 border rounded",onChange:e=>C(+e.target.value),value:k,children:Array.from({length:q},(e,t)=>(0,s.jsxs)("option",{value:t,children:["Halaman ",t+1]},t))})}),(0,s.jsxs)("div",{className:"relative border",style:{width:"fit-content"},children:[(0,s.jsx)(v,{fileBuffer:r,currentPage:k,onLoad:D,onPageSize:_,signatureURL:"",position:{x:T,y:F},sigSize:{w:M,h:U},onRenderScaleChange:()=>{}}),E&&(0,s.jsx)(o.p,{bounds:"parent",default:{x:A.height/2-450,y:A.height/2,width:M,height:U},onDragStop:(e,t)=>{R(t.x),z(t.y)},onResizeStop:(e,t,r,s,a)=>{H(r.offsetWidth),K(r.offsetHeight),R(a.x),z(a.y)},className:"z-50",children:(0,s.jsx)("div",{className:"w-full h-full border-2 border-blue-500 bg-white/40 rounded-md flex items-center justify-center text-sm text-blue-700 font-semibold",children:"Signature"})})]})]}):(0,s.jsx)("div",{className:"flex justify-center items-center w-full h-full",children:(0,s.jsx)("h4",{className:"text-center",children:"Dokumen akan ditampilkan di sini"})})}),(0,s.jsx)("div",{className:"md:col-span-5 col-span-12 px-4",children:(0,s.jsxs)("div",{className:"space-y-4 w-full max-w-sm",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(l.J,{htmlFor:"upload-pdf",children:"Unggah Dokumen PDF"}),(0,s.jsx)(i.p,{id:"upload-pdf",type:"file",accept:"application/pdf",onChange:$,className:"cursor-pointer"})]}),S&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.S,{id:"terms-2",checked:E,onCheckedChange:e=>G(!!e)}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(l.J,{htmlFor:"terms-2",className:"font-medium",children:"Tanda Tangan Digital"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"Centang untuk menampilkan kolom tanda tangan di atas dokumen sebagai verifikasi digital."})]})]}),!E&&(0,s.jsxs)("div",{className:"grid gap-2 mt-3",children:[(0,s.jsx)(l.J,{htmlFor:"signature-desc",children:"Konfirmasi Tanda Tangan"}),(0,s.jsx)(g,{data:j,labelKey:"nama",valueKey:"npp",filterKey:"nama",filterExclude:"ADMINISTRATOR",placeholder:"Pilih Pegawai",onChange:e=>{J(e)}})]}),(0,s.jsxs)("div",{className:"grid gap-2 mt-3",children:[(0,s.jsx)(l.J,{htmlFor:"signature-desc",children:"Konfirmasi Tanda Tangan"}),(0,s.jsx)(i.p,{id:"signature-desc",type:"text",placeholder:"Masukkan deskripsi",value:B,onChange:e=>I(e.target.value)})]})]}),S&&(0,s.jsx)(s.Fragment,{children:E?(0,s.jsx)(m.$,{variant:"default",onClick:()=>{O("sign")},children:"Sign"}):(0,s.jsx)(m.$,{variant:"default",onClick:()=>{O("send")},children:"Send"})}),S&&(0,s.jsx)(m.$,{className:"ml-3",variant:"default",onClick:()=>{O("draft")},children:"Draft"})]})})]}),P&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 bg-white p-6 rounded-xl shadow-lg",children:[(0,s.jsx)(x.A,{className:"h-6 w-6 animate-spin text-primary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Memproses data..."})]})})]})}},40615:(e,t,r)=>{Promise.resolve().then(r.bind(r,34053))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,825,767,398,134,474,634,784,475,567,438,251,363,146],()=>r(23258));module.exports=s})();