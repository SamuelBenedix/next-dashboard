(()=>{var e={};e.id=974,e.ids=[974],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11860:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(62688).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21204:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/page.tsx","default")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},49692:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var r=a(65239),s=a(48088),n=a(88170),i=a.n(n),o=a(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(t,l);let d={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,21204)),"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94431)),"/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/samuelbenedict/Documents/GitHub/next-dashboard/src/app/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57939:(e,t,a)=>{Promise.resolve().then(a.bind(a,70724))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70724:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var r=a(60687),s=a(43210),n=a(30036),i=a(29523),o=a(903),l=a(62688);let d=(0,l.A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),c=(0,l.A)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var u=a(16023);a(45837),a(44719);var p=a(83767),h=a(39941);async function g(e){return new Promise((t,a)=>{let r=document.createElement("canvas"),s=r.getContext("2d"),n=new Image;n.crossOrigin="Anonymous",n.src=e,n.onload=()=>{r.width=n.width,r.height=n.height,s?.drawImage(n,0,0),t(r.toDataURL("image/png"))},n.onerror=()=>{a(Error("Gagal memuat gambar"))}})}async function m({imageUrl:e,x:t,y:a,pdfBytes:r,selectedPage:s,width:n=100,height:i=50}){let o=await p.PDFDocument.load(r),l=o.getPages()[s-1];if(!l)throw Error(`Page ${s} not found in PDF`);e.endsWith(".png")||(e=await g(e));let d=await fetch(e).then(e=>e.arrayBuffer()),c=await o.embedPng(d),u=t,h=a;return n>60||i>60?h=a-i+47:n<60||i<60?h=a-(i-45):(h=a-18,u=t+3),l.drawImage(c,{x:u,y:h,width:n,height:i}),await o.save()}let x=new h.x;async function f({signatureDataURL:e,x:t,y:a,pdfBytes:r,selectedPage:s,width:n=100,height:i=50}){try{let o=await p.PDFDocument.load(r),l=o.getPages()[s-1],d=await o.embedPng(e),c=await w(r instanceof ArrayBuffer?r:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength));return console.log("Signature:",e),console.log("x:",t,"y:",a,"width:",n,"height:",i),console.log("Original orientation:",c),l.drawImage(d,{x:t,y:a,width:n,height:i}),await o.save()}catch(e){throw console.error("Error adding signature to PDF:",e),e}}async function w(e){return(1&new Uint8Array(e.slice(17,18))[0])==0?"Potrait":"Landscape"}async function y(e){let t=new Blob([e],{type:"application/pdf"}),a=new FormData;a.append("file",t,"pdf-with-signature.pdf");try{return await x.uploadFile(a)}catch(e){throw console.error("Upload error:",e),e}}let b=async({documentURL:e,capturedSignature:t,selectedImageUrl:a,currentPage:r,xCoordinate:s,yCoordinate:n,pdfPaperWidth:i,pdfPaperHeight:o,scale:l,fileBytesOverride:d,width:c,height:u})=>{if(!e)return void console.error("documentURL is empty");let p=d??await fetch(e).then(e=>e.arrayBuffer()),h=n,g=s;if(t){try{let e=await f({signatureDataURL:t,x:g,y:h,pdfBytes:p,selectedPage:r,width:c,height:u}),a=await y(e);a&&"object"==typeof a&&"object"in a&&a.object&&"object"==typeof a.object&&"id"in a.object&&localStorage.setItem("IdUpload",a.object.id)}catch(e){console.error("Error uploading signature file:",e)}return}if(a){let e=o/3,t=i/3;l>1&&(n<=e?h-=15:n<=2*e?h-=10:h-=3,g+=s<=t?3:s<=2*t?10:15);try{let e=await m({imageUrl:a,x:g,y:h,pdfBytes:p,selectedPage:r,width:c,height:u}),t=await y(e);t&&"object"==typeof t&&"object"in t&&t.object&&"object"==typeof t.object&&"id"in t.object&&localStorage.setItem("IdUpload",t.object.id)}catch(e){console.error("Error uploading image file:",e)}return}alert("Please capture a signature or select an image preview first.")},v=(0,l.A)("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),j=(0,l.A)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);var k=a(67146),P=a(16189);function N(){let[e,t]=(0,s.useState)(!1),a=(0,P.useRouter)();return(0,r.jsx)("header",{className:"w-full px-4 py-3 shadow-sm border-b bg-white",children:(0,r.jsxs)("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[(0,r.jsx)("div",{children:(0,r.jsx)("img",{src:"/BNI_logo.svg",alt:"e-Signature Logo",className:"h-8"})}),(0,r.jsx)("div",{className:"hidden sm:block",children:(0,r.jsx)(i.$,{variant:"outline",className:"text-sm",onClick:()=>a.push("/login"),children:"Login"})}),(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsxs)(k.cj,{open:e,onOpenChange:t,children:[(0,r.jsx)(k.CG,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"ghost",size:"icon",children:(0,r.jsx)(j,{className:"w-5 h-5"})})}),(0,r.jsx)(k.h,{side:"right",className:"w-64",children:(0,r.jsx)("div",{className:"mt-4 space-y-4",children:(0,r.jsx)(i.$,{variant:"outline",className:"text-sm",onClick:()=>a.push("/login"),children:"Login"})})})]})})]})})}let C=new h.x,S=(0,n.default)(async()=>{},{loadableGenerated:{modules:["app/page.tsx -> @/components/ui/PdfRenderer"]},ssr:!1});function U(){let[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)(null),[l,p]=(0,s.useState)(null),[h,g]=(0,s.useState)(null),[m,x]=(0,s.useState)({x:0,y:0}),[f,w]=(0,s.useState)({w:100,h:50}),[y,j]=(0,s.useState)(!1),k=(0,s.useRef)(null),P=(0,s.useRef)(null),[U,L]=(0,s.useState)(0),[R,D]=(0,s.useState)({width:0,height:0}),[q,A]=(0,s.useState)({width:0,height:0}),[E,F]=(0,s.useState)(0),[z,B]=(0,s.useState)(0),[M,_]=(0,s.useState)(!1);console.log("pdfRenderedSize",R),console.log("pdfOriginalSize",q);let I=async e=>{let a=e.target.files?.[0];if(!a)return;let r=URL.createObjectURL(a);p(r),localStorage.setItem("documentURL",r);let s=await a.arrayBuffer(),i=new Uint8Array(s.byteLength);if(i.set(new Uint8Array(s)),n(i),!a||"application/pdf"!==a.type)return void alert("Mohon unggah file PDF!");t(await a.arrayBuffer()),g(null)},G=async e=>{let t=localStorage.getItem("IdUpload"),a=new Date,r=`${a.getDate()}${a.getMonth()+1}${a.getFullYear()}`;try{let a=await C.downloadFile({FileId:t}),s=new Blob([a],{type:"application/pdf"}),n=window.URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=`${r}_BNI_SignatureNonCertificate.pdf`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n),e(100)}catch(e){throw console.error("Error downloading file:",e),e}},$=async()=>{if(!a||!h)return void alert("Upload PDF dan tanda tangan terlebih dahulu!");_(!0);try{let e=m.x,t=R.height-m.y-f.h-250,r=f.w,s=f.h-20;console.log("width",r),console.log("height",s),await b({documentURL:l,capturedSignature:h,selectedImageUrl:"",currentPage:E+1,xCoordinate:e,yCoordinate:t,pdfPaperWidth:R.width,pdfPaperHeight:R.height,scale:1,fileBytesOverride:a,width:r,height:s}),await G(L),alert("Berhasil mengunggah PDF yang telah dimodifikasi.")}catch(e){console.error("Error uploading PDF:",e),alert("Gagal mengunggah PDF")}finally{_(!1)}};return console.log("progress",U),(0,r.jsxs)("div",{children:[(0,r.jsx)(N,{}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-6 py-12",children:[(0,r.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold text-teal-800 flex items-center gap-2",children:["Tanda Tangan Elektronik",(0,r.jsx)(d,{className:"w-6 h-6"})]}),(0,r.jsx)("input",{ref:P,id:"pdf-upload",type:"file",accept:"application/pdf",className:"hidden",onChange:I}),(0,r.jsxs)(i.$,{onClick:()=>{P.current?.click()},className:"bg-teal-800 hover:bg-teal-700 text-white text-base px-6 py-2 rounded-md shadow-md flex items-center gap-2",children:["Upload File",(0,r.jsx)(c,{className:"w-5 h-5"})]}),(0,r.jsx)("div",{className:"p-6 max-w-4xl mx-auto space-y-4",children:e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("select",{className:"p-2 border rounded",onChange:e=>F(+e.target.value),value:E,children:Array.from({length:z},(e,t)=>(0,r.jsxs)("option",{value:t,children:["Halaman ",t+1]},t))}),(0,r.jsxs)("label",{className:"cursor-pointer flex items-center gap-2 p-2 border rounded hover:bg-gray-100",children:[(0,r.jsx)(u.A,{className:"w-5 h-5"}),(0,r.jsx)("input",{type:"file",accept:"image/png, image/jpeg",onChange:e=>{let t=e.target.files?.[0];if(t&&t.size<=2097152){let e=new FileReader;e.onload=()=>g(e.result),e.readAsDataURL(t)}else alert("Maksimal ukuran gambar adalah 2MB.")},className:"hidden"})]}),(0,r.jsx)(i.$,{type:"button",variant:"outline",className:"p-2",title:"Tanda Tangan Manual",onClick:()=>j(!0),children:(0,r.jsx)(v,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"relative border",style:{width:"fit-content"},children:[(0,r.jsx)(S,{fileBuffer:e,currentPage:E,onLoad:e=>B(e),onPageSize:e=>{console.log("size",e),D(e)},onRenderScaleChange:(e,t,a)=>{console.log("pdf w",t),console.log("pdf h",a),A({width:t,height:a})},signatureURL:h,position:m,sigSize:f}),h&&(0,r.jsx)(o.p,{size:{width:f.w,height:f.h},position:{x:m.x,y:m.y},onDragStop:(e,t)=>{x({x:t.x,y:t.y})},onResizeStop:(e,t,a)=>{console.log("ref.style.",a.style),w({w:parseFloat(a.style.width),h:parseFloat(a.style.height)})},bounds:"parent",lockAspectRatio:!0,style:{zIndex:10,border:"2px dashed #3b82f6",borderRadius:"4px"},children:(0,r.jsx)("img",{src:h,alt:"signature",className:"w-full h-full object-contain",style:{pointerEvents:"none",userSelect:"none"}})})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(i.$,{variant:"secondary",onClick:()=>g(null),disabled:!h,children:"Hapus Tanda Tangan"}),(0,r.jsx)(i.$,{onClick:$,disabled:M,children:M?"Mengekspor...":"Ekspor PDF Bertanda Tangan"})]}),y&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-lg w-[500px] max-w-full",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Buat Tanda Tangan"}),(0,r.jsx)("canvas",{ref:k,width:400,height:200,className:"border border-gray-300 rounded cursor-crosshair",onMouseDown:e=>{let t=k.current;if(!t)return;let a=t.getContext("2d");if(!a)return;a.beginPath();let r=t.getBoundingClientRect();a.moveTo(e.clientX-r.left,e.clientY-r.top);let s=e=>{a.lineTo(e.clientX-r.left,e.clientY-r.top),a.stroke()},n=()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",n)};window.addEventListener("mousemove",s),window.addEventListener("mouseup",n)}}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,r.jsx)(i.$,{variant:"ghost",onClick:()=>{let e=k.current;if(!e)return;let t=e.getContext("2d");t&&t.clearRect(0,0,e.width,e.height)},children:"Clear"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.$,{variant:"secondary",onClick:()=>j(!1),children:"Batal"}),(0,r.jsx)(i.$,{onClick:()=>{let e=k.current;e&&(g(e.toDataURL("image/png")),j(!1))},children:"Gunakan Tanda Tangan"})]})]})]})})]})})]})]})}},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")},97851:(e,t,a)=>{Promise.resolve().then(a.bind(a,21204))}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[447,825,767,398,134,784,857,251],()=>a(49692));module.exports=r})();